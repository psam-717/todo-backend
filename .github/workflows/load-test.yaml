# .github/workflows/load-test.yml
name: Load Test

on: 
 push:
   branches: [main, develop]
 pull_request:
 workflow_dispatch:
   

jobs:
  load-test:
   runs-on: ubuntu-latest
   steps:
     - uses: actions/checkout@v4
     - uses: actions/setup-node@v4
       with:
         node-version: '20'
     - run: npm ci
     - run: npm run build
     - run: npm start & 
       env:
        PORT: 4000
     - run: sleep 15
     - run: npx artillery run artillery/load-test.yaml --output report.json
     - uses: actions/upload-artifact@v4
       with:
         name: artillery report
         path: report.json
